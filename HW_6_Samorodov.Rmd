# Домашнее задание 6

## Самородов К.С.

Пусть наш спонсор заинтересован, чтобы исследование имело 80% мощность, а уровень значимости — 5%, ожидаемый drop-out rate = 10%.

```{r}
alpha <- 0.05
power <- 0.80
dropout_rate <- 0.10
```

# Задание 1. 
Рассчитать выборку для исследования терапевтической эквивалентности для двухпериодного cross-over дизайна. Из предыдущих исследований известно, что дисперсия составляет 20% (sigma = 0.20), а разница средних составляет −10% (epsilon). Клиницисты сообщают нам, что клинически значимая разница составляет 25% (delta = 0.25).

```{r}
sigma <- 0.20
epsilon <- -0.10
delta <- 0.25
z_alpha_2 <- qnorm(1 - alpha/2)
z_beta <- qnorm(power)
n <- ((z_alpha_2 + z_beta)^2 * sigma^2) / (2 * (delta - abs(epsilon))^2)
n <- n / (1 - dropout_rate)
n_total <- n * 2
```

## Результат
```{r}
cat("Размер выборки для каждой группы (n1 = n2):", round(n), "\n")
cat("Общий размер выборки (учитывая оба периода) (n_total):", round(n_total), "\n")
```
# Задание 2. 
Рассчитать выборку для гипотезы non-inferiority для двухвыборочного параллельного дизайна. Пусть клинически значимая разница  δ = -0.1, то есть мы ожидаем разницу не меньше 10%, а долю ответов для тестового препарата p2  = 0.65, в то время как нам известно из предыдущих исследований, что доля ответов у препарата сравнения составляет p1  = 0.85. Соотношение групп равно k  = 1.

```{r}
delta <- -0.1
p2 <- 0.65
k <- 1
z_alpha_2 <- qnorm(1 - alpha/2)
z_beta <- qnorm(power)
n <- ((((z_alpha_2 + z_beta)^2) * (p1 * (1 - p1) + p2 * (1 - p2))) / (p1 - p2 - delta)^2) * k
n <- n / (1 - dropout_rate)
n_total <- n * 2
```

## Результат
```{r}
cat("Размер выборки для каждой группы (n1 = n2):", round(n), "\n")
cat("Общий размер выборки (учитывая оба периода) (n_total):", round(n_total), "\n")
```

# Задание 3. 
Рассчитать выборку для гипотезы equality для следующего исследования. Мы хотим сравнить новую терапию инфекции, присоединяющейся в больничных условиях у пациентов с ожогами, с золотым стандартом, основываясь на данных, анализируемых с помощью регрессии Кокса. Пусть отношение рисков «золотой стандарт / новая терапия», hazard ratio, HR = 2. Мы предполагаем, что 80% пациентов (d = 0.8) могут столкнуться с этим заболеванием. Соотношения групп терапии равны (p1=p2=0.5).

```{r}
HR <- 2
d <- 0.8
p1 <- 0.5
p2 <- 0.5
z_alpha_2 <- qnorm(1 - alpha/2)
z_beta <- qnorm(power)
n <- ((z_alpha_2 + z_beta)^2) / ((log(HR)^2) * p1 * p2 * d)
n <- n / (1 - dropout_rate)
n_total <- n * 2
```

## Результат
```{r}
cat("Размер выборки для каждой группы (n1 = n2):", round(n), "\n")
cat("Общий размер выборки (учитывая оба периода) (n_total):", round(n_total), "\n")
```

